{"version":3,"sources":["../../../../src/scene.js"],"names":["window","onload","Detector","webgl","ua","navigator","userAgent","is_ie","indexOf","document","getElementById","innerHTML","theScene","Scene","warning","getWebGLErrorMessage","console","log","mythis","export","stop_on_next","hide_controls","container","loadingdiv","playdiv","scene","THREE","renderer","WebGLRenderer","antialias","alpha","camera","PerspectiveCamera","innerWidth","innerHeight","cameralookat","Vector3","shadowMap","enabled","setSize","appendChild","domElement","audiolistener","AudioListener","add","app_preloaded","fps","animationstart","now","then","Date","interval","delta","frame","currentsong","gui","SceneGui","stats","Stats","showPanel","style","position","bottom","zIndex","addEventListener","e","preventDefault","stopplay","display","preloaded","initScene","stage","orbitcontrols","OrbitControls","set","lookAt","onWindowResize","aspect","updateProjectionMatrix","directionalLight","DirectionalLight","rotation","geometry","PlaneGeometry","material","MeshStandardMaterial","color","side","DoubleSide","transparent","opacity","floor","Mesh","Math","PI","loadJSON","response","playlist","JSON","parse","songs","location","songcount","length","songi","i","Song","onLoaded","loaded","j","visibility","setTimeout","init","initAnimate","play","which","title","mp3file","substring","updateSongTitle","paused","requestAnimationFrame","animate","stop","fastforward","render","updateScene","update","round","updateAnimation","file","callback","xobj","XMLHttpRequest","overrideMimeType","open","onreadystatechange","readyState","status","responseText","send"],"mappings":"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","sourcesContent":["(() => {\n\n  //Detect and start game\n  window.onload = () => {\n    if(Detector.webgl){\n      var ua = navigator.userAgent;\n      //console.log('ua', ua);\n      var is_ie = ua.indexOf(\"MSIE \") > -1 || ua.indexOf(\"Trident/\") > -1;\n      if(is_ie){\n        document.getElementById('loading').innerHTML = 'Please use a different browser. This site works best in Chrome.';\n      }else{\n        const theScene = new Scene();\n      }\n    }else{\n      const warning = Detector.getWebGLErrorMessage();\n      console.log('webgl warning', warning);\n      document.getElementById('loading').innerHTML = 'This browser does not support WebGL';\n    }\n  }\n\n  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\n  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\n  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\n  //GAME INIT////////////////////////////////////////////////////////////////////////////////////////////////////\n  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\n  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\n  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\n  class Scene {\n    constructor() {\n      const mythis = this;\n\n      //Backend connection\n      /*this.socket = io.connect('http://localhost:3000');*/\n      this.export = false; //Not really working\n      this.stop_on_next = false;\n      this.hide_controls = true;\n\n      //Scene variables\n      this.container = document.getElementById('container');\n      this.loadingdiv = document.getElementById('loading');\n      this.playdiv = document.getElementById('playdiv');\n      this.scene = new THREE.Scene();\n      this.renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });\n      this.camera = new THREE.PerspectiveCamera(10, window.innerWidth / window.innerHeight, 0.1, 10000);\n      this.cameralookat = new THREE.Vector3(0, 1.2, 0);\n      this.renderer.shadowMap.enabled = true;\n      this.renderer.setSize(window.innerWidth, window.innerHeight);\n      this.container.appendChild(this.renderer.domElement);\n      this.audiolistener = new THREE.AudioListener();\n      this.camera.add(this.audiolistener);\n\n      //Variables\n      this.app_preloaded = false;\n      this.fps = 24;\n      this.animationstart = 0;\n      this.now;\n      this.then = Date.now();\n      this.interval = 1000/this.fps;\n      this.delta;\n      this.frame = 0;\n      this.currentsong = 0;\n\n      this.gui = new SceneGui(this);\n      //if(this.hide_controls) this.gui.updateVisibility(false);\n\n      //Stats\n      this.stats = new Stats();\n      this.stats.showPanel( 1 ); // 0: fps, 1: ms, 2: mb, 3+: custom\n      this.stats.domElement.style.position = 'absolute';\n      this.stats.domElement.style.bottom = '0px';\n      this.stats.domElement.style.zIndex = 100;\n      if(!this.hide_controls) this.container.appendChild( this.stats.domElement );\n\n      //Controls\n      document.getElementById('game-stop').addEventListener('click', e => {\n        e.preventDefault();\n        mythis.stopplay();\n      });\n\n      document.getElementById('playdiv-begin').addEventListener('click', e => {\n        e.preventDefault();\n        mythis.playdiv.style.display = 'none';\n        if(!mythis.app_preloaded){\n          mythis.preloaded();\n        }else{\n          mythis.stopplay();\n        }\n      });\n\n      //Initialize\n      this.initScene();\n    }\n\n    initScene(stage) {\n      const mythis = this;\n\n      ////////////////////////////////////////////////////////////////////////////\n      //SCENE/////////////////////////////////////////////////////////////////////\n      ////////////////////////////////////////////////////////////////////////////\n\n      // CONTROLS\n      this.orbitcontrols = new THREE.OrbitControls(this.camera, this.renderer.domElement);\n\n      //Camera\n      this.camera.position.set(0, -10, 22); //-15, 10, 20 | 0, 3, 20 | -10, 5, 10\n      this.camera.lookAt(this.cameralookat);\n      window.addEventListener('resize', onWindowResize, false);\n      function onWindowResize(){\n          mythis.camera.aspect = window.innerWidth / window.innerHeight;\n          mythis.camera.updateProjectionMatrix();\n          mythis.renderer.setSize( window.innerWidth, window.innerHeight );\n      }\n\n      //LIGHT\n      /*var light = new THREE.PointLight( 0xffffff, 1);\n      light.position.set(0, 1, 3);\n      this.scene.add( light );\n      var pointLightHelper = new THREE.PointLightHelper(light, 0.1);\n      this.scene.add( pointLightHelper );*/\n\n      //LIGHT\n      const directionalLight = new THREE.DirectionalLight( 0xffffff, 0.5 );\n      directionalLight.rotation.set(0, 0, 0);\n      directionalLight.position.set(0,0,5);\n      this.scene.add( directionalLight );\n      //var helper = new THREE.DirectionalLightHelper( directionalLight, 1 );\n      //this.scene.add( helper );\n\n      //Sky Fog\n      /*const skyBoxGeometry = new THREE.CubeGeometry( 20, 20, 20);\n      const skyBoxMaterial = new THREE.MeshBasicMaterial( { color: 0x000000, side: THREE.BackSide } );\n      const skyBox = new THREE.Mesh( skyBoxGeometry, skyBoxMaterial );\n      skyBox.name = 'skybox';\n      this.scene.add(skyBox);*/\n\n      //Floor\n      let geometry = new THREE.PlaneGeometry( 2, 4 );\n      let material = new THREE.MeshStandardMaterial( {color: 0xffffff, side: THREE.DoubleSide, transparent:true, opacity:0.2} );\n      this.floor = new THREE.Mesh( geometry, material );\n      this.floor.position.set(0, 0, 0);\n      this.floor.rotation.set(Math.PI / 2, 0, 0);\n      this.scene.add( this.floor );\n\n      ////////////////////////////////////////////////////////////////////////////\n      //PLAYLIST//////////////////////////////////////////////////////////////////\n      ////////////////////////////////////////////////////////////////////////////\n\n      //Load playlist json\n      this.loadJSON('content/_playlist.json', response => {\n        mythis.playlist = JSON.parse(response);\n        //console.log('playlist', mythis.playlist);\n\n        //Songs\n        mythis.songs = [];\n        let location = '';\n\n        //Foreach Song, load hidden\n        let songcount = mythis.playlist.songs.length;\n        let songi = 0;\n        //songcount = 1;\n        for(let i=0; i<songcount; i++){\n          location = 'content/'+mythis.playlist.songs[i]+'/';\n          mythis.songs[i] = new Song(mythis, location, '_analysis_files.json', '_config.json', mythis.scene, mythis.audiolistener, mythis.fps, mythis.hide_controls);\n          mythis.songs[i].onLoaded = () => {\n            //console.log(mythis.songs[i]);\n            songi++;\n            mythis.loadingdiv.innerHTML = '<img src=\"img/loading-icon.gif\" width=\"30\" /><br>Loading Interactive Experience<br>Song '+songi+' of '+songcount+' loaded';\n\n            //Detect when all loaded\n            let loaded = true;\n            for(let j=0; j<songcount; j++){\n              if(!mythis.songs[j].loaded){\n                loaded = false;\n              }\n            }\n            if(loaded){\n              mythis.loadingdiv.style.visibility = 'hidden';\n              mythis.playdiv.style.display = 'block';\n              //mythis.loadingdiv.innerHTML = 'Scroll around the objects with your mouse or finger.<br>Use the top controls to navigate the songs.';\n              //mythis.loadingdiv.innerHTML += '<br><br><a href=\"#\" id=\"play-button\">begin</a>';\n              //document.getElementById('play-button').addEventListener('click', e => {\n              //  e.preventDefault();\n                //mythis.preloaded();\n              //});\n            }\n          };\n        }\n      });\n\n    }\n\n    preloaded(){\n      var mythis = this;\n      this.app_preloaded = true;\n      this.loadingdiv.style.visibility='hidden';\n      setTimeout(function(){\n        //console.log('preloaded');\n        mythis.gui.init();\n        mythis.initAnimate();\n        mythis.play(mythis.currentsong);\n      }, 1000);\n    }\n\n    //////////////////////////////////////////////////////////////////////////////\n    //PLAYBACK////////////////////////////////////////////////////////////////////\n    //////////////////////////////////////////////////////////////////////////////\n    play(which){\n      if(which) this.currentsong = which;\n      this.songs[this.currentsong].play(0);\n      var title = '\"' + this.songs[this.currentsong].mp3file.substring(0, this.songs[this.currentsong].mp3file.length - 4) + '\"';\n      this.gui.updateSongTitle(title);\n    }\n\n    stopplay(){\n      var mythis = this;\n      if(this.paused){\n        this.songs[this.currentsong].play();\n        this.playdiv.style.display = 'none';\n        this.paused = false;\n        requestAnimationFrame(() => { mythis.animate(); });\n      }else{\n        this.songs[this.currentsong].stop();\n        this.playdiv.style.display = 'block';\n        this.paused = true;\n      }\n    }\n\n    fastforward(){\n      this.songs[this.currentsong].fastforward();\n    }\n\n    nextsong(){\n      if(this.stop_on_next){\n        this.stopplay();\n      }else{\n        var mythis = this;\n        this.songs[this.currentsong].stop();\n        setTimeout(function(){\n          mythis.currentsong++;\n          if(mythis.currentsong == mythis.playlist.songs.length) mythis.currentsong = 0;\n          mythis.play();\n        }, 0);\n      }\n    }\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\n    ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\n    ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\n    //ANIMATE//////////////////////////////////////////////////////////////////////////////////////////////////////\n    ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\n    ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\n    ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\n    initAnimate() {\n      const mythis = this;\n      this.paused = false;\n      this.frame = 0;\n      this.animationstart = Date.now();\n\n      this.renderer.render(this.scene, this.camera);\n      requestAnimationFrame(() => {\n        mythis.animate();\n      });\n    }\n\n    animate() {\n      const mythis = this;\n      //if(!this.paused){ requestAnimationFrame(() => { mythis.animate(); }); };\n      requestAnimationFrame(() => { mythis.animate(); });\n\n      //Frame quantization\n      this.now = Date.now();\n      this.delta = this.now - this.then;\n      if(this.delta > this.interval){\n\n        //Update scene\n        this.updateScene();\n\n        //Turnaround\n        this.then = this.now - (this.delta % this.interval);\n        this.renderer.render(this.scene, this.camera);\n        if(this.export){\n          //this.socket.emit('render-frame', {frame: mythis.frame, file: document.querySelector('canvas').toDataURL()});\n        }\n        this.stats.update();\n        this.frame = Math.round((this.now - this.animationstart) / 41.666666666); //1000ms / 24fps = 41.666666666\n      }\n    }\n\n    updateScene() {\n      this.songs[this.currentsong].updateAnimation();\n      this.camera.lookAt(this.cameralookat);\n    }\n\n    loadJSON(file, callback) {\n      const xobj = new XMLHttpRequest();\n      xobj.overrideMimeType(\"application/json\");\n      xobj.open('GET', file, true);\n      xobj.onreadystatechange = () => {\n        if(xobj.readyState == 4 && xobj.status == \"200\") {callback(xobj.responseText);}\n      };\n      xobj.send(null);\n    }\n  }\n})();\n\n\n\n\n\n\n\n\n\n\n\n\n\n//\n"],"file":"scene-compiled.js"}