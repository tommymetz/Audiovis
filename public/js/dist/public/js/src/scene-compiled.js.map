{"version":3,"sources":["../../../../src/scene.js"],"names":["window","onload","Detector","webgl","ua","navigator","userAgent","is_ie","indexOf","document","getElementById","innerHTML","theScene","Scene","warning","getWebGLErrorMessage","console","log","mythis","export","stop_on_next","hide_controls","container","loadingdiv","scene","THREE","renderer","WebGLRenderer","antialias","alpha","camera","PerspectiveCamera","innerWidth","innerHeight","cameralookat","Vector3","shadowMap","enabled","setSize","appendChild","domElement","audiolistener","AudioListener","add","fps","animationstart","now","then","Date","interval","delta","frame","currentsong","gui","SceneGui","stats","Stats","showPanel","style","position","bottom","zIndex","addEventListener","e","preventDefault","stopplay","initScene","stage","orbitcontrols","OrbitControls","set","lookAt","onWindowResize","aspect","updateProjectionMatrix","directionalLight","DirectionalLight","rotation","geometry","PlaneGeometry","material","MeshStandardMaterial","color","side","DoubleSide","transparent","opacity","floor","Mesh","Math","PI","loadJSON","response","playlist","JSON","parse","songs","location","songcount","length","songi","i","Song","onLoaded","loaded","j","preloaded","visibility","setTimeout","init","initAnimate","play","which","title","mp3file","substring","updateSongTitle","paused","requestAnimationFrame","animate","stop","fastforward","render","updateScene","update","round","updateAnimation","file","callback","xobj","XMLHttpRequest","overrideMimeType","open","onreadystatechange","readyState","status","responseText","send"],"mappings":"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","sourcesContent":["(() => {\n\n  //Detect and start game\n  window.onload = () => {\n    if(Detector.webgl){\n      ua = navigator.userAgent;\n      //console.log('ua', ua);\n      var is_ie = ua.indexOf(\"MSIE \") > -1 || ua.indexOf(\"Trident/\") > -1;\n      if(is_ie){\n        document.getElementById('loading').innerHTML = 'Please use a different browser. This site works best in Chrome.';\n      }else{\n        const theScene = new Scene();\n      }\n    }else{\n      const warning = Detector.getWebGLErrorMessage();\n      console.log('webgl warning', warning);\n      document.getElementById('loading').innerHTML = 'This browser does not support WebGL';\n    }\n  }\n\n  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\n  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\n  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\n  //GAME INIT////////////////////////////////////////////////////////////////////////////////////////////////////\n  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\n  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\n  ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\n  class Scene {\n    constructor() {\n      const mythis = this;\n\n      //Backend connection\n      /*this.socket = io.connect('http://localhost:3000');*/\n      this.export = false; //Not really working\n      this.stop_on_next = false;\n      this.hide_controls = true;\n\n      //Scene variables\n      this.container = document.getElementById('container');\n      this.loadingdiv = document.getElementById('loading');\n      this.scene = new THREE.Scene();\n      this.renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });\n      this.camera = new THREE.PerspectiveCamera(10, window.innerWidth / window.innerHeight, 0.1, 10000);\n      this.cameralookat = new THREE.Vector3(0, 1.2, 0);\n      this.renderer.shadowMap.enabled = true;\n      this.renderer.setSize(window.innerWidth, window.innerHeight);\n      this.container.appendChild(this.renderer.domElement);\n      this.audiolistener = new THREE.AudioListener();\n      this.camera.add(this.audiolistener);\n\n      //Variables\n      this.fps = 24;\n      this.animationstart = 0;\n      this.now;\n      this.then = Date.now();\n      this.interval = 1000/this.fps;\n      this.delta;\n      this.frame = 0;\n      this.currentsong = 0;\n\n      this.gui = new SceneGui(this);\n      //if(this.hide_controls) this.gui.updateVisibility(false);\n\n      //Stats\n      this.stats = new Stats();\n      this.stats.showPanel( 1 ); // 0: fps, 1: ms, 2: mb, 3+: custom\n      this.stats.domElement.style.position = 'absolute';\n      this.stats.domElement.style.bottom = '0px';\n      this.stats.domElement.style.zIndex = 100;\n      if(!this.hide_controls) this.container.appendChild( this.stats.domElement );\n\n      //Controls\n      document.getElementById('game-stop').addEventListener('click', e => {\n        e.preventDefault();\n        mythis.stopplay();\n      });\n\n      //Initialize\n      this.initScene();\n    }\n\n    initScene(stage) {\n      const mythis = this;\n\n      ////////////////////////////////////////////////////////////////////////////\n      //SCENE/////////////////////////////////////////////////////////////////////\n      ////////////////////////////////////////////////////////////////////////////\n\n      // CONTROLS\n      this.orbitcontrols = new THREE.OrbitControls(this.camera, this.renderer.domElement);\n\n      //Camera\n      this.camera.position.set(0, 3, 26); //-15, 10, 20 | 0, 3, 20 | -10, 5, 10\n      this.camera.lookAt(this.cameralookat);\n      window.addEventListener('resize', onWindowResize, false);\n      function onWindowResize(){\n          mythis.camera.aspect = window.innerWidth / window.innerHeight;\n          mythis.camera.updateProjectionMatrix();\n          mythis.renderer.setSize( window.innerWidth, window.innerHeight );\n      }\n\n      //LIGHT\n      /*var light = new THREE.PointLight( 0xffffff, 1);\n      light.position.set(0, 1, 3);\n      this.scene.add( light );\n      var pointLightHelper = new THREE.PointLightHelper(light, 0.1);\n      this.scene.add( pointLightHelper );*/\n\n      //LIGHT\n      const directionalLight = new THREE.DirectionalLight( 0xffffff, 0.5 );\n      directionalLight.rotation.set(0, 0, 0);\n      directionalLight.position.set(0,0,5);\n      this.scene.add( directionalLight );\n      //var helper = new THREE.DirectionalLightHelper( directionalLight, 1 );\n      //this.scene.add( helper );\n\n      //Sky Fog\n      /*const skyBoxGeometry = new THREE.CubeGeometry( 20, 20, 20);\n      const skyBoxMaterial = new THREE.MeshBasicMaterial( { color: 0x000000, side: THREE.BackSide } );\n      const skyBox = new THREE.Mesh( skyBoxGeometry, skyBoxMaterial );\n      skyBox.name = 'skybox';\n      this.scene.add(skyBox);*/\n\n      //Floor\n      const geometry = new THREE.PlaneGeometry( 2, 4 );\n      const material = new THREE.MeshStandardMaterial( {color: 0xffffff, side: THREE.DoubleSide, transparent:true, opacity:0.2} );\n      this.floor = new THREE.Mesh( geometry, material );\n      this.floor.position.set(0, 0, 0);\n      this.floor.rotation.set(Math.PI / 2, 0, 0);\n      this.scene.add( this.floor );\n\n      ////////////////////////////////////////////////////////////////////////////\n      //PLAYLIST//////////////////////////////////////////////////////////////////\n      ////////////////////////////////////////////////////////////////////////////\n\n      //Load playlist json\n      this.loadJSON('content/_playlist.json', response => {\n        mythis.playlist = JSON.parse(response);\n        //console.log('playlist', mythis.playlist);\n\n        //Songs\n        mythis.songs = [];\n        let location = '';\n\n        //Foreach Song, load hidden\n        let songcount = mythis.playlist.songs.length;\n        let songi = 0;\n        //let songcount = 2;\n        for(let i=0; i<songcount; i++){\n          location = 'content/'+mythis.playlist.songs[i]+'/';\n          mythis.songs[i] = new Song(mythis, location, '_analysis_files.json', '_config.json', mythis.scene, mythis.audiolistener, mythis.fps, mythis.hide_controls);\n          mythis.songs[i].onLoaded = () => {\n            //console.log(mythis.songs[i]);\n            songi++;\n            mythis.loadingdiv.innerHTML = '<img src=\"img/loading-icon.gif\" width=\"30\" /><br>Loading Interactive Experience<br>Song '+songi+' of '+songcount+' loaded';\n\n            //Detect when all loaded\n            let loaded = true;\n            for(let j=0; j<songcount; j++){\n              if(!mythis.songs[j].loaded){\n                loaded = false;\n              }\n            }\n            if(loaded){\n              mythis.preloaded();\n            }\n          };\n        }\n      });\n\n    }\n\n    preloaded(){\n      var mythis = this;\n      this.loadingdiv.style.visibility='hidden';\n      setTimeout(function(){\n        //console.log('preloaded');\n        mythis.gui.init();\n        mythis.initAnimate();\n        mythis.play(mythis.currentsong);\n      }, 1000);\n    }\n\n    //////////////////////////////////////////////////////////////////////////////\n    //PLAYBACK////////////////////////////////////////////////////////////////////\n    //////////////////////////////////////////////////////////////////////////////\n    play(which){\n      if(which) this.currentsong = which;\n      this.songs[this.currentsong].play(0);\n      var title = '\"' + this.songs[this.currentsong].mp3file.substring(0, this.songs[this.currentsong].mp3file.length - 4) + '\"';\n      this.gui.updateSongTitle(title);\n    }\n\n    stopplay() {\n      var mythis = this;\n      if(this.paused){\n        this.songs[this.currentsong].play();\n        this.paused = false;\n        requestAnimationFrame(() => { mythis.animate(); });\n      }else{\n        this.songs[this.currentsong].stop();\n        this.paused = true;\n      }\n    }\n\n    fastforward(){\n      this.songs[this.currentsong].fastforward();\n    }\n\n    nextsong(){\n      if(this.stop_on_next){\n        this.stopplay();\n      }else{\n        var mythis = this;\n        this.songs[this.currentsong].stop();\n        setTimeout(function(){\n          mythis.currentsong++;\n          if(mythis.currentsong == mythis.playlist.songs.length) mythis.currentsong = 0;\n          mythis.play();\n        }, 0);\n      }\n    }\n\n    ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\n    ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\n    ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\n    //ANIMATE//////////////////////////////////////////////////////////////////////////////////////////////////////\n    ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\n    ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\n    ///////////////////////////////////////////////////////////////////////////////////////////////////////////////\n    initAnimate() {\n      const mythis = this;\n      this.paused = false;\n      this.frame = 0;\n      this.animationstart = Date.now();\n\n      this.renderer.render(this.scene, this.camera);\n      requestAnimationFrame(() => {\n        mythis.animate();\n      });\n    }\n\n    animate() {\n      const mythis = this;\n      if(!this.paused){ requestAnimationFrame(() => { mythis.animate(); }); };\n\n      //Frame quantization\n      this.now = Date.now();\n      this.delta = this.now - this.then;\n      if(this.delta > this.interval){\n\n        //Update scene\n        this.updateScene();\n\n        //Turnaround\n        this.then = this.now - (this.delta % this.interval);\n        this.renderer.render(this.scene, this.camera);\n        if(this.export){\n          //this.socket.emit('render-frame', {frame: mythis.frame, file: document.querySelector('canvas').toDataURL()});\n        }\n        this.stats.update();\n        this.frame = Math.round((this.now - this.animationstart) / 41.666666666); //1000ms / 24fps = 41.666666666\n      }\n    }\n\n    updateScene() {\n      this.songs[this.currentsong].updateAnimation();\n      this.camera.lookAt(this.cameralookat);\n    }\n\n    loadJSON(file, callback) {\n      const xobj = new XMLHttpRequest();\n      xobj.overrideMimeType(\"application/json\");\n      xobj.open('GET', file, true);\n      xobj.onreadystatechange = () => {\n        if(xobj.readyState == 4 && xobj.status == \"200\") {callback(xobj.responseText);}\n      };\n      xobj.send(null);\n    }\n  }\n})();\n\n\n\n\n\n\n\n\n\n\n\n\n\n//\n"],"file":"scene-compiled.js"}