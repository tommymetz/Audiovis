{"version":3,"sources":["../../../../../src/models/triangles.js"],"names":["Triangles","scene","stem","color","mythis","zeroed","yoffset","initTriangles","generateTriangleGeometry","CENTROID_LENGTH","centroids","length","MAX_POINTS","geometry","THREE","BufferGeometry","positions","Float32Array","normals","addAttribute","BufferAttribute","material","MeshBasicMaterial","side","DoubleSide","wireframe","triangles","Mesh","position","x","y","rootobject","add","trianglesmirror","rotation","Math","PI","attributes","array","positionlength","trianglecount","scale","size","z","i","random","index","needsUpdate","volume","log10","frame","multiplyer","factor","maxvolume","set"],"mappings":"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","sourcesContent":["class Triangles {\n  constructor(scene, stem, color) {\n    const mythis = this;\n    this.scene = scene;\n    this.stem = stem;\n    this.color = color;\n    this.zeroed = false;\n    this.yoffset = 0.15;\n    this.initTriangles();\n    this.generateTriangleGeometry();\n  }\n\n  initTriangles(){\n    const CENTROID_LENGTH = this.stem.centroids[0].length;\n    const MAX_POINTS = CENTROID_LENGTH * 2;\n    const geometry = new THREE.BufferGeometry();\n    var positions = new Float32Array(MAX_POINTS * 3);\n    const normals = new Float32Array(MAX_POINTS * 3);\n    geometry.addAttribute('position', new THREE.BufferAttribute(positions, 3));\n    geometry.addAttribute('normal', new THREE.BufferAttribute(normals, 3));\n    const material = new THREE.MeshBasicMaterial({color: this.color, side: THREE.DoubleSide, wireframe:false});\n    this.triangles = new THREE.Mesh(geometry, material);\n    this.triangles.position.x = 0;\n    this.triangles.position.y = this.yoffset;\n    //this.triangles.position.y = this.stem.offsety;\n    this.stem.rootobject.add(this.triangles);\n\n    //Triangles Mirror\n    this.trianglesmirror = new THREE.Mesh(geometry, material);\n    this.trianglesmirror.position.x = 0;\n    this.trianglesmirror.position.y = this.yoffset;\n    this.trianglesmirror.rotation.y = Math.PI / 1;\n    this.stem.rootobject.add(this.trianglesmirror);\n  }\n\n  generateTriangleGeometry(){\n    var positions = this.triangles.geometry.attributes.position.array;\n    const positionlength = positions.length/3;\n    const trianglecount = 10;//positionlength/3;\n    const scale = 1;\n    const size = 0.5;\n    let x;\n    let y;\n    let z;\n    for(let i=0; i<trianglecount*3; i++){\n      if ( i % 3 === 0 ) {\n          x = 0;\n          y = 0;\n          z = 0;\n      } else {\n          x = x + size * ( Math.random() - 0.5 );\n          y = y + size * ( Math.random() - 0.5 );\n          z = 0;\n      }\n      const index = 3 * i;\n      positions[ index     ] = x;\n      positions[ index + 1 ] = y;\n      positions[ index + 2 ] = z;\n    }\n    this.triangles.geometry.attributes.position.needsUpdate = true;\n  }\n\n  updateTriangles() {\n    let volume = Math.log10(this.stem.volume[this.stem.frame] / this.stem.multiplyer * this.stem.factor * this.stem.maxvolume) / 1;\n    if(volume <= 0.5){\n      if(!this.zeroed){\n        this.generateTriangleGeometry();\n        this.zeroed = true;\n      }\n    }else{\n      if(this.zeroed) this.zeroed = false;\n    }\n\n    //Scale\n    if(volume <= 0) volume = 0.0001;\n    this.triangles.scale.set(volume,volume,volume);\n    this.trianglesmirror.scale.set(volume,volume,volume);\n  }\n\n  updateColor(color){\n    this.triangles.material.color.set(color);\n    this.trianglesmirror.material.color.set(color);\n  }\n\n\n\n  //\n}\n"],"file":"triangles-compiled.js"}