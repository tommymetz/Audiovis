{"version":3,"file":"song-compiled.js","names":["Song","parent","location","songjsonfile","attributesjson","scene","audiolistener","fps","hide_controls","arguments","length","undefined","_classCallCheck","mythis","active","audiotrack","THREE","Audio","add","mp3file","firststarttime","ignoreending","stemnames","stems","loadingstage","order","colors","loaded","visible","gui","SongGui","stemgroup","Group","position","set","frame","offset","starttime","isLoaded","onLoaded","init","loadJSON","concat","response","json","JSON","parse","audiofiles","attributes","colorindex","colorset","eval","forEach","element","index","push","loader","AudioLoader","load","audioBuffer","setBuffer","setLoop","setVolume","onEnded","updateVisibility","nextsong","i","createStem","_createClass","key","value","name","thestem","Stem","j","updateStemOrder","updateOrder","updateStemColor","which","color","updateColors","updateSoloing","checked","hide","show","play","offsetframes","isPlaying","stop","context","currentTime","fastforward","time","buffer","duration","setTimeout","updateAnimation","audioframe","Math","round","isNaN","file","callback","xobj","XMLHttpRequest","overrideMimeType","open","onreadystatechange","readyState","status","responseText","send"],"sources":["../../../../src/song.js"],"sourcesContent":["class Song {\n  constructor(parent, location, songjsonfile, attributesjson, scene, audiolistener, fps, hide_controls=false) {\n    const mythis = this;\n    this.parent = parent;\n    this.location = location;\n    this.songjsonfile = songjsonfile;\n    this.attributesjson = attributesjson;\n    this.scene = scene;\n    this.audiolistener = audiolistener;\n    this.fps = fps;\n    this.hide_controls = hide_controls;\n\n    //Variables\n    this.active = false;\n    this.audiotrack = new THREE.Audio(this.audiolistener);\n    this.scene.add(this.audiotrack);\n    this.mp3file;\n    this.firststarttime = 0;\n    this.ignoreending = false;\n    this.stemnames = [];\n    this.stems = [];\n    this.loadingstage = 0;\n    this.order = [];\n    this.colors = [];\n    this.loaded = false;\n    this.visible = false;\n\n    this.gui = new SongGui(this);\n\n    this.stemgroup = new THREE.Group();\n    this.stemgroup.position.set(0,0,1.2);\n    this.scene.add(this.stemgroup);\n\n    this.frame = 0;\n    this.offset = 0;\n    this.starttime = 0;\n\n    //onLoaded handler\n    this.isLoaded = function() {\n      if(typeof this.onLoaded === \"function\"){\n        this.loaded = true;\n        this.gui.init();\n        this.onLoaded();\n      }\n    };\n\n    //Load JSON\n    //mythis.loadJSON(`${mythis.location + mythis.songjsonfile}?v=${Math.round(Math.random()*1000)}`, response => {\n    mythis.loadJSON(`${mythis.location + mythis.songjsonfile}`, response => {\n      const json = JSON.parse(response);\n      mythis.mp3file = json[0].mp3file;\n      mythis.stemnames = json[0].audiofiles;\n\n      //Load attributes\n      //mythis.loadJSON(`${mythis.location + mythis.attributesjson}?v=${Math.round(Math.random()*1000)}`, response => {\n      mythis.loadJSON(`${mythis.location + mythis.attributesjson}`, response => {\n        const json = JSON.parse(response);\n        mythis.attributes = json;\n\n        //Colors\n        if(mythis.attributes.colors.length == 0){\n\n          //Populate with colorset\n          let colorindex = 0;\n          let colorset = eval(mythis.attributes.colorset);\n          mythis.stemnames.forEach(function(element, index){\n            mythis.colors.push(colorset[colorindex]);\n            colorindex++;\n            if(index == colorset.length-1) colorindex = 0;\n          });\n        }else{\n          mythis.colors = mythis.attributes.colors;\n        }\n\n        //Order\n        if(mythis.attributes.order.length == 0){\n          mythis.stemnames.forEach(function(element, index){\n            mythis.order.push(index);\n          });\n        }else{\n          mythis.order = mythis.attributes.order;\n        }\n\n        //Load mp3file\n        const loader = new THREE.AudioLoader();\n        loader.load(mythis.location + mythis.mp3file, audioBuffer => {\n          mythis.audiotrack.setBuffer( audioBuffer );\n          mythis.audiotrack.setLoop(false);\n          mythis.audiotrack.setVolume(1.0);\n          mythis.audiotrack.onEnded = function(){\n            if(!mythis.ignoreending){\n              if(mythis.visible){\n                mythis.updateVisibility(false);\n                mythis.parent.nextsong();\n              }\n            }\n          };\n\n          //Create stems\n          for(let i=0; i<mythis.stemnames.length; i++){\n            mythis.stems[i] = mythis.createStem(mythis.stemnames[i], i, mythis.order[i]);\n          }\n        });\n      });\n    });\n  }\n\n  createStem(name, i, order) {\n    const mythis = this;\n\n    //Create the stem\n    const thestem = new Stem(this.location, name, i, order, this.scene, this.stemgroup, this.colors[i]);\n    thestem.onLoaded = () => {\n\n      //If all stems are loaded\n      let loaded = true;\n      for(let j=0; j<mythis.stemnames.length; j++){\n        if(!mythis.stems[j].loaded){\n          loaded = false;\n        }\n      }\n      if(loaded){\n        mythis.isLoaded();\n      }\n    }\n    return thestem;\n  }\n\n  //////////////////////////////////////////////////////////////////////////////\n  //VISUALS/////////////////////////////////////////////////////////////////////\n  //////////////////////////////////////////////////////////////////////////////\n  updateVisibility(visible){\n    this.visible = visible;\n    if(this.hide_controls){\n      this.gui.updateVisibility(false);\n    }else{\n      this.gui.updateVisibility(visible);\n    }\n    for(let i=0; i<this.stemnames.length; i++){\n      this.stems[i].updateVisibility(visible);\n    }\n  }\n\n  updateStemOrder(order){\n    for(let i=0; i<this.stemnames.length; i++){\n      this.stems[i].updateOrder(order[i]);\n    }\n  }\n\n  updateStemColor(which, color){\n    this.stems[which].updateColors(color);\n  }\n\n  updateSoloing(which, checked){\n    if(checked){\n      this.stems.forEach(function(element, index){\n        if(which != index) element.hide();\n      });\n    }else{\n      this.stems.forEach(function(element, index){\n        element.show();\n      });\n    }\n  }\n\n  //////////////////////////////////////////////////////////////////////////////\n  //PLAYBACK////////////////////////////////////////////////////////////////////\n  //////////////////////////////////////////////////////////////////////////////\n  play(offset = 0) {\n    var mythis = this;\n    this.offset = offset;\n    this.offsetframes = this.offset * this.fps;\n\n    //Playback\n    if(this.audiotrack.isPlaying) this.audiotrack.stop();\n    this.audiotrack.offset = this.offset;\n    this.audiotrack.play();\n    // Capture the audio context time when play is called\n    this.starttime = this.audiotrack.context.currentTime;\n    this.updateVisibility(true);\n  }\n\n  stop(){\n    this.updateVisibility(false);\n    if(this.audiotrack.isPlaying) this.audiotrack.stop();\n  }\n\n  fastforward(){\n    var mythis = this;\n    this.ignoreending = true;\n    var time = this.audiotrack.context.currentTime + this.audiotrack.offset + 5;\n    if(time < this.audiotrack.buffer.duration){\n      this.play(time);\n      setTimeout(function(){ mythis.ignoreending = false; }, 10); //Revert after ending fired\n    }else{\n      this.updateVisibility(false);\n      this.parent.nextsong();\n    }\n  }\n\n  //////////////////////////////////////////////////////////////////////////////\n  //ANIMATE/////////////////////////////////////////////////////////////////////\n  //////////////////////////////////////////////////////////////////////////////\n  updateAnimation() {\n    if(this.visible){\n      var audioframe = (this.audiotrack.context.currentTime - this.starttime) * this.fps;\n      this.frame = Math.round(audioframe + this.offsetframes); //1000ms / 24fps = 41.666666666\n      \n      // Guard against NaN frame values\n      if (isNaN(this.frame) || this.frame < 0) {\n        return;\n      }\n      \n      for(let i=0; i<this.stems.length; i++){\n        this.stems[i].updateAnimation(this.frame);\n      }\n    }\n  }\n\n  //////////////////////////////////////////////////////////////////////////////\n  //UTIL////////////////////////////////////////////////////////////////////////\n  //////////////////////////////////////////////////////////////////////////////\n  loadJSON(file, callback) {\n    const xobj = new XMLHttpRequest();\n    xobj.overrideMimeType(\"application/json\");\n    xobj.open('GET', file, true);\n    xobj.onreadystatechange = () => {\n      if(xobj.readyState == 4 && xobj.status == \"200\") {callback(xobj.responseText);}\n    };\n    xobj.send(null);\n  }\n\n\n\n\n  //var audioframe = Math.round((this.audiotrack.context.currentTime - this.audiotrack.startTime) * this.fps) - this.startframe + this.offsetframes; //1000ms / 24fps = 41.666666666\n\n\n\n\n\n\n\n\n\n  /*\n\n\n\n  //Load master json file\n  /*var loader = new THREE.FileLoader(this.loadingmanager);\n  loader.load(this.songjsonfile + \"?v=\" + Math.round(Math.random()*1000), function(data){\n    mythis.stems = JSON.parse(data)[0].audiofiles;\n  });\n  */\n\n\n\n\n  //\n}\n"],"mappings":"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","ignoreList":[]}